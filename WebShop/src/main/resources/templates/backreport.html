<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
	<title>Checkout</title>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="description" content="aStar Fashion Template Project">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" type="text/css" href="styles/bootstrap-4.1.3/bootstrap.css">
	<link href="plugins/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
	<link rel="stylesheet" type="text/css" href="plugins/OwlCarousel2-2.2.1/owl.carousel.css">
	<link rel="stylesheet" type="text/css" href="plugins/OwlCarousel2-2.2.1/owl.theme.default.css">
	<link rel="stylesheet" type="text/css" href="plugins/OwlCarousel2-2.2.1/animate.css">
	<link rel="stylesheet" type="text/css" href="styles/checkout.css">
	<link rel="stylesheet" type="text/css" href="styles/checkout_responsive.css">
	<script src="js/echarts.min.js"></script>
</head>
<body>

<div class="super_container">

	<!-- Header -->

	<header class="header">
		<div class="header_content d-flex flex-row align-items-center justify-content-start">

			<!-- Hamburger -->
			<div class="hamburger menu_mm"><i class="fa fa-bars menu_mm" aria-hidden="true"></i></div>

			<!-- Logo -->
			<div class="header_logo">
				<a href="#"><div>E-<span>shop</span></div></a>
			</div>

			<!-- Navigation -->
			<nav class="header_nav">
				<ul class="d-flex flex-row align-items-center justify-content-start">
					<li><a href="/checkout">商品管理</a></li>
					<li><a href="/backreport">销售统计报表/销售状态管理</a></li>
					<li><a href="/history">顾客浏览/购买日志</a></li>
				</ul>
			</nav>

			<!-- Header Extra -->
			<div class="header_extra ml-auto d-flex flex-row align-items-center justify-content-start">

			</div>

		</div>
	</header>

	<!-- Menu -->

	<div class="menu d-flex flex-column align-items-start justify-content-start menu_mm trans_400">
		<div class="menu_close_container"><div class="menu_close"><div></div><div></div></div></div>
		<div class="menu_top d-flex flex-row align-items-center justify-content-start">


		</div>
		<nav class="menu_nav">
			<ul class="menu_mm">
				<li><a href="/checkout">商品管理</a></li>
				<li><a href="/backreport">销售统计报表/销售状态管理</a></li>
				<li><a href="/history">顾客浏览/购买日志</a></li>
			</ul>
		</nav>
		<div class="menu_extra">
			<div class="menu_social">
				<ul>
					<li><a href="#"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li>
					<li><a href="#"><i class="fa fa-facebook" aria-hidden="true"></i></a></li>
					<li><a href="#"><i class="fa fa-instagram" aria-hidden="true"></i></a></li>
					<li><a href="#"><i class="fa fa-twitter" aria-hidden="true"></i></a></li>
				</ul>
			</div>
		</div>
	</div>

	<!-- Sidebar -->

	<div class="sidebar">

		<!-- Info -->
		<div class="info">
			<div class="info_content d-flex flex-row align-items-center justify-content-start">


			</div>
		</div>

		<!-- Logo -->
		<div class="sidebar_logo">
			<a href="#"><div>E-<span>shop</span></div></a>
		</div>

		<!-- Sidebar Navigation -->
		<nav class="sidebar_nav">
			<ul>
				<li><a href="/checkout">商品管理<i class="fa fa-angle-right" aria-hidden="true"></i></a></li>
				<li><a href="/backreport">销售统计报表/销售状态管理<i class="fa fa-angle-right" aria-hidden="true"></i></a></li>
				<li><a href="/history">顾客浏览/购买日志<i class="fa fa-angle-right" aria-hidden="true"></i></a></li>
			</ul>
		</nav>

	</div>

	<!-- Home -->

	<div class="home">
		<div class="parallax_background parallax-window" data-parallax="scroll" data-image-src="images/checkout.jpg" data-speed="0.8"></div>
		<div style="float: right">
			<div style="padding: 5px"><a style="font-size: 20px;font-weight: 600;color: rgba(29,33,36,0.42);cursor: default" href="#" th:text="'Welcome : ' + ${adname}"></a></div>
			<div style="float:right;padding: 5px"><a style="font-size: 20px;font-weight: 600;color: rgba(29,33,36,0.42)" href="/logout">Logout</a></div>
		</div>
		<div class="home_container">
			<div class="home_content">
				<div class="home_title">销售管理</div>
			</div>
		</div>
	</div>

	<!-- Checkout -->

	<div class="checkout">
		<div class="section_container">
			<div class="container">
				<div class="row">
					<div class="col">
						<div class="checkout_container d-flex flex-xxl-row flex-column align-items-start justify-content-start">
							<div id="echarts" style="height: 800px;width: 100%"></div>
						</div>
						<div class="checkout_container d-flex flex-xxl-row flex-column align-items-start justify-content-start">

							<!-- Billing -->
							<div class="billing checkout_box"  style="width: 100% !important">
								<div class="checkout_title">销售统计报表</div>
								<br>
								<br>
								<table class="table table-striped table-sm">
									<thead>
									<tr style="color:#16181b">
										<th>商品名称</th>
										<th>售价</th>
										<th>售出数量</th>
										<th>销售金额</th>
										<th>剩余库存</th>
									</tr>
									</thead>
									<tbody>
										<tr  th:each="report : ${reports}" style="color:#706368">
											<td th:text="${report.getName()}" style="font-weight: 800;padding-top: 10px;padding-bottom: 10px"></td>
											<td th:text="${report.getPrice()}" style="padding-top: 10px;padding-bottom: 10px"></td>
											<td th:text="${report.getSell()}" style="padding-top: 10px;padding-bottom: 10px"></td>
											<td th:text="${report.getSellamout()}" style="padding-top: 10px;padding-bottom: 10px"></td>
											<td th:text="${report.getNum()}" style="padding-top: 10px;padding-bottom: 10px"></td>
										</tr>
									</tbody>
								</table>
								<div style="float: right"><h2 style="color: black">总销售金额：<span id="money"></span></h2></div>
							</div>
						</div>
						<br>
						<br>
						<div class="checkout_container d-flex flex-xxl-row flex-column align-items-start justify-content-start">

							<!-- Billing -->
							<div class="billing checkout_box"  style="width: 100% !important">
								<div class="checkout_title">销售状态</div>
								<br>
								<br>
								<table class="table table-striped table-sm">
									<thead>
									<tr style="color:#16181b">
										<th>买家</th>
										<th>商品</th>
										<th>售价</th>
										<th>购买数量</th>
										<th>总金额</th>
										<th>日期</th>
										<th>状态</th>
									</tr>
									</thead>
									<tbody>
									<tr  th:each="crecord : ${crecords}" style="color:#706368">
										<td th:text="${crecord.getUsername()}" style="font-weight: 800;padding-top: 10px;padding-bottom: 10px"></td>
										<td th:text="${crecord.getName()}" style="padding-top: 10px;padding-bottom: 10px"></td>
										<td th:text="${crecord.getPrice()}" style="padding-top: 10px;padding-bottom: 10px"></td>
										<td th:text="${crecord.getAmout()}" style="padding-top: 10px;padding-bottom: 10px"></td>
										<td th:text="${crecord.getTotal()}" style="padding-top: 10px;padding-bottom: 10px"></td>
										<td th:text="${crecord.getDate()}" style="padding-top: 10px;padding-bottom: 10px"></td>
										<td th:text="${crecord.getState()}" style="padding-top: 10px;padding-bottom: 10px" th:id="${crecord.getId()}"></td>
										<td style="padding-top: 10px;padding-bottom: 10px"><a onclick="deliver(this)" th:title="${crecord.getId()}" th:if="${crecord.getState()} ne '已发货'" style="font-weight: 800;color:rgba(38,125,245,0.88);cursor:pointer">确认发货</a></td>
									</tr>
									</tbody>
								</table>
							</div>
						</div>


					</div>
				</div>
			</div>
		</div>
	</div>



	<!-- Credits -->
	<div class="credits">
		<div class="section_container">
			<div class="container">
				<div class="row">
					<div class="col">
						<div class="credits_content d-flex flex-row align-items-center justify-content-end">
							<div class="credits_text">
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	</footer>

</div>

<script src="js/jquery-3.2.1.min.js"></script>
<script src="styles/bootstrap-4.1.3/popper.js"></script>
<script src="styles/bootstrap-4.1.3/bootstrap.min.js"></script>
<script src="plugins/greensock/TweenMax.min.js"></script>
<script src="plugins/greensock/TimelineMax.min.js"></script>
<script src="plugins/scrollmagic/ScrollMagic.min.js"></script>
<script src="plugins/greensock/animation.gsap.min.js"></script>
<script src="plugins/greensock/ScrollToPlugin.min.js"></script>
<script src="plugins/OwlCarousel2-2.2.1/owl.carousel.js"></script>
<script src="plugins/easing/easing.js"></script>
<script src="plugins/parallax-js-master/parallax.min.js"></script>
<script src="js/checkout.js"></script>
<script type="text/javascript">
    function deliver(data) {
        $.ajax({
            url:"/deliver",
            type:"post",
            data:{"id": data.title},
            success:function f() {
				var temp = document.getElementById(data.title);
				temp.innerHTML = "已发货";
				data.innerHTML = "";
            }
		})
    }
</script>
<script th:inline="javascript">
    // 基于准备好的dom，初始化echarts实例
    var myChart = echarts.init(document.getElementById('echarts'));
    var reports = [[${reports}]];
    var good = [];
    var sell = [];
    var num = [];
    var total = 0;
    for(var i = 0;i < reports.length;i++){
        good.push(reports[i].name);
        sell.push(reports[i].sell);
        num.push(reports[i].num);
        total = total + reports[i].sellamout;
	}
	var money = document.getElementById("money");
	money.innerHTML = total;
    myChart.setOption({
        title: {
            text: '销售统计柱状图'
        },
        tooltip: {
            trigger: 'axis',
            axisPointer: {
                type: 'shadow'
            }
        },
        legend: {
            data: ['售出数量', '剩余库存']
        },
        grid: {
            left: '3%',
            right: '4%',
            bottom: '3%',
            containLabel: true
        },
        xAxis: {
            type: 'value',
            boundaryGap: [0, 0.01]
        },
        yAxis: {
            type: 'category',
            data: good
        },
        series: [
            {
                name: '售出数量',
                type: 'bar',
                data: sell
            },
            {
                name: '剩余库存',
                type: 'bar',
                data: num
            }
        ]
    });

</script>
</body>
</html>